"use strict";(self.webpackChunkbp_13=self.webpackChunkbp_13||[]).push([[490],{7490:(te,v,o)=>{o.r(v),o.d(v,{ListsModule:()=>q});var c=o(9808),e=o(5e3),p=o(9318);let h=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,t){1&i&&e._UZ(0,"router-outlet")},directives:[p.lC],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:auto}"]}),n})();var C=o(4483),u=o(8892),L=o(6105),r=o(8356),_=o(5861),d=o(3075),b=o(7579),T=o(9841),m=o(2722),U=o(4004),f=o(5698),I=o(9893),y=o(963);function w(n,l){if(1&n&&(e.TgZ(0,"button",17),e._UZ(1,"nb-icon",18),e._uU(2," Ulo\u017eit "),e.qZA()),2&n){const i=e.oxw();e.Q6J("disabled",!(i.listForm.valid&&i.assetsWorkingList.length>0))}}function A(n,l){if(1&n&&(e.TgZ(0,"button",19),e._UZ(1,"nb-icon",20),e._uU(2," P\u0159epsat "),e.qZA()),2&n){const i=e.oxw();e.Q6J("disabled",!(i.listForm.valid&&i.assetsWorkingList.length>0))}}let F=(()=>{class n{constructor(i,t,s,a,ee){this.fb=i,this.nbSidebarService=t,this.assetsService=s,this.listsService=a,this.nbToastrService=ee,this.assetsWorkingList=[],this.editedListId=void 0,this.unsubscribe=new b.x,this.listForm=this.fb.group({listName:[null,[d.kI.required,d.kI.maxLength(200)]],category:[null,[d.kI.maxLength(200)]],connected:[!1],archived:[!1],description:[null,[d.kI.maxLength(1e3)]]})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnInit(){this.assetsService.getAssetsWorkingList$().pipe((0,m.R)(this.unsubscribe)).subscribe(i=>this.assetsWorkingList=Array.from(i.values())),(0,T.a)([this.listsService.getAssetsLists(),this.listForm.valueChanges]).pipe((0,U.U)(([i,t])=>{var s;return null===(s=i.find(a=>a.name===t.listName.trim()))||void 0===s?void 0:s.id}),(0,m.R)(this.unsubscribe)).subscribe(i=>this.editedListId=i)}close(){this.nbSidebarService.toggle(!0,"saveListForm")}submit(i){var t=this;return(0,_.Z)(function*(){if(!t.editedListId)throw new Error("id mus\xed b\xfdt vypln\u011bno");const s={id:t.editedListId,name:i.value.listName,category:i.value.category,connected:i.value.connected,description:i.value.description,archived:i.value.archived,assets:t.assetsWorkingList};t.editedListId?t.listsService.updateAssetsList(s).pipe((0,f.q)(1)).subscribe():t.listsService.createAssetsList(s).pipe((0,f.q)(1)).subscribe({next:()=>{t.nbToastrService.success("\xfasp\u011b\u0161n\u011b ulo\u017eena","Sestava",{icon:"link-outline",duration:2e3})},error:a=>{401===a.status?t.nbToastrService.danger("nep\u0159ihl\xe1\u0161en\xfd u\u017eivatel si nem\u016f\u017ee ulo\u017eit sestavu","Nep\u0159ihl\xe1\u0161en",{icon:"person-outline",duration:1e4}):t.nbToastrService.danger("do\u0161lo k chyb\u011b","Ne\xfasp\u011bch",{duration:1e4,icon:"alert-triangle-outline"})}})})()}}return n.\u0275fac=function(i){return new(i||n)(e.Y36(d.qu),e.Y36(r.lzT),e.Y36(I.z),e.Y36(y.$),e.Y36(r.quB))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-save-list"]],decls:26,vars:3,consts:[["fxFlex","","fxLayout","column","fxLayoutGap","1em",1,"likeAgGrid",3,"formGroup","ngSubmit"],["nbPrefix","","icon","list-outline"],["formControlName","listName","nbInput","","fieldSize","tiny","placeholder","N\xe1zev sestavy","fullWidth",""],["nbPrefix","","icon","npm-outline"],["formControlName","category","nbInput","","fieldSize","tiny","placeholder","Kategorie","fullWidth",""],["fxLayout","row","fxLayoutAlign","start center"],["fxFlex",""],["icon","link-2-outline"],["formControlName","connected","status","danger",1,"size-tiny"],["icon","archive-outline"],["formControlName","archived","status","primary",1,"size-tiny"],["formControlName","description","nbInput","","fxFlex","","fullWidth","","placeholder","Popis","fieldSize","tiny"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","1em"],["nbButton","","type","button","status","basic","outline","",3,"click"],["icon","close-outline"],["nbButton","","status","primary","outline","",3,"disabled",4,"ngIf","ngIfElse"],["rewrite",""],["nbButton","","status","primary","outline","",3,"disabled"],["icon","save-outline"],["nbButton","","status","warning","outline","",3,"disabled"],["icon","edit-2-outline"]],template:function(i,t){if(1&i&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return t.submit(t.listForm)}),e.TgZ(1,"nb-form-field"),e._UZ(2,"nb-icon",1)(3,"input",2),e.qZA(),e.TgZ(4,"nb-form-field"),e._UZ(5,"nb-icon",3)(6,"input",4),e.qZA(),e.TgZ(7,"div",5)(8,"div",6),e._UZ(9,"nb-icon",7),e._uU(10," Sv\xe1zan\xe1 sestava "),e.qZA(),e._UZ(11,"nb-toggle",8),e.qZA(),e.TgZ(12,"div",5)(13,"div",6),e._UZ(14,"nb-icon",9),e._uU(15," Archivovan\xe1 "),e.qZA(),e._UZ(16,"nb-toggle",10),e.qZA(),e.TgZ(17,"div",6),e._UZ(18,"textarea",11),e.qZA(),e.TgZ(19,"div",12)(20,"button",13),e.NdJ("click",function(){return t.close()}),e._UZ(21,"nb-icon",14),e._uU(22," Zav\u0159\xedt "),e.qZA(),e.YNc(23,w,3,1,"button",15),e.YNc(24,A,3,1,"ng-template",null,16,e.W1O),e.qZA()()),2&i){const s=e.MAs(25);e.Q6J("formGroup",t.listForm),e.xp6(23),e.Q6J("ngIf",!t.editedListId)("ngIfElse",s)}},directives:[d._Y,d.JL,u.yH,u.xw,u.SQ,d.sg,r.jBG,r.fMN,r.t3q,d.Fj,r.h8i,d.JJ,d.u,u.Wh,r.BLq,r.DPz,c.O5],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex}  app-save-list textarea[nbInput].size-tiny{padding-top:1em;padding-bottom:1em;height:100%;resize:none}"]}),n})();var x=o(7148);function N(n,l){if(1&n){const i=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){return e.CHM(i),e.oxw(),e.MAs(4).toggle(!0)}),e._UZ(1,"nb-icon",11),e._uU(2," Ulo\u017een\xed sestavy "),e.qZA()}}function D(n,l){if(1&n){const i=e.EpF();e.TgZ(0,"div",12),e.NdJ("click",function(){return e.CHM(i),e.oxw(),e.MAs(4).toggle(!0)}),e._UZ(1,"nb-icon",13),e._uU(2," Zav\u0159\xedt "),e.qZA()}}function R(n,l){1&n&&e._UZ(0,"app-save-list")}function O(n,l){if(1&n&&e._UZ(0,"app-assets-grid",14),2&n){const i=l.ngIf,t=e.oxw();e.Q6J("assets",i)("gridUid",t.gridUid)}}const k=function(n){return{"ng-sidebar-overlay-fix":n}};let M=(()=>{class n{constructor(i){this.facade=i,this.gridUid="assetList",this.assetsWorkingList$=this.facade.getAssetExt(C._.WORKING_LIST)}}return n.\u0275fac=function(i){return new(i||n)(e.Y36(C.h))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-working-list"]],decls:11,vars:10,consts:[["fxLayout","column",2,"height","100%",3,"ngClass"],[3,"gridUid"],[2,"display","flex","flex-grow","1","overflow","hidden"],["tag","saveListForm","state","compacted","containerFixed","false",2,"height","100%"],["ref",""],["class","toggleButton",3,"click",4,"ngIf"],["fxFlex","",2,"margin-top","15px"],["class","caption","fxLayout","row","fxLayoutAlign","start center",3,"click",4,"ngIf"],[4,"ngIf"],[3,"assets","gridUid",4,"ngIf"],[1,"toggleButton",3,"click"],["icon","list-outline"],["fxLayout","row","fxLayoutAlign","start center",1,"caption",3,"click"],["icon","arrowhead-left-outline"],[3,"assets","gridUid"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-views-bar",1),e.TgZ(2,"div",2)(3,"nb-sidebar",3,4),e.YNc(5,N,3,0,"div",5),e.TgZ(6,"div",6),e.YNc(7,D,3,0,"div",7),e.YNc(8,R,1,0,"app-save-list",8),e.qZA()(),e.YNc(9,O,1,2,"app-assets-grid",9),e.ALo(10,"async"),e.qZA()()),2&i){const s=e.MAs(4);e.Q6J("ngClass",e.VKq(8,k,s.compacted)),e.xp6(1),e.Q6J("gridUid",t.gridUid),e.xp6(4),e.Q6J("ngIf",s.compacted),e.xp6(2),e.Q6J("ngIf",!s.compacted),e.xp6(1),e.Q6J("ngIf",!s.compacted),e.xp6(1),e.Q6J("ngIf",e.lcZ(10,6,t.assetsWorkingList$))}},directives:[u.xw,c.mk,L.z,r.nZR,c.O5,r.fMN,u.yH,u.Wh,F,x.K],pipes:[c.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block}"]}),n})();var g=o(6757),z=o(6397),W=o(9300),J=o(3360),G=o(8691),P=o(8593),B=o(1453),Y=o(5647),E=o(1956),S=o(4448),Q=o(974);const j=function(n){return{"ag-filterActive":n}};let $=(()=>{class n extends J.R{constructor(i,t,s,a){super(),this.listsService=i,this.categoriesService=t,this.dialogService=s,this.agGridInstanceService=a,this.columnDefs=[],this.defaultColDef={checkboxSelection:g.O.ifColumnIsFirst,headerCheckboxSelection:g.O.ifColumnIsFirst,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,enableRowGroup:!0,resizable:!0},this.gridOptions={},this.gridContext={},this.unsubscribe=new b.x,this.gridUid="listsList",this.rowData$=this.listsService.getAssetsLists()}static getColDefs(){return[{headerName:"#",valueGetter:i=>{var t;const s=null===(t=null==i?void 0:i.node)||void 0===t?void 0:t.rowIndex;return s?s+1:null},suppressMovable:!0,width:70,minWidth:70,pinned:"left",lockPinned:!0,floatingFilterComponentFramework:G.X,floatingFilterComponentParams:{suppressFilterButton:!0}},{field:"name",filter:"agTextColumnFilter",headerName:"Jm\xe9no"},{field:"category",filter:"agTextColumnFilter",headerName:"Kategorie"},{field:"connected",filter:"agSetColumnFilter",headerName:"Sv\xe1zan\xe1",cellRenderer:"booleanCellRenderer",filterParams:{values:[!0,!1]}},{field:"description",filter:"agTextColumnFilter",headerName:"Popis"},{valueGetter:i=>{var t,s,a;return null===(a=null===(s=null===(t=i.node)||void 0===t?void 0:t.data)||void 0===s?void 0:s.assets)||void 0===a?void 0:a.length},filter:"agTextColumnFilter",headerName:"Po\u010det polo\u017eek"},{field:"archived",filter:"agSetColumnFilter",headerName:"Archivovan\xe1",cellRenderer:"booleanCellRenderer",filterParams:{values:[!0,!1]}},{field:"created",filter:"agDateColumnFilter",headerName:"Vytvo\u0159ena",valueFormatter:this.dateTimeFormatter},{field:"updated",filter:"agDateColumnFilter",headerName:"Upravena",valueFormatter:this.dateTimeFormatter}]}ngOnInit(){this.agGridInstanceService.getGridInstance(this.gridUid).pipe((0,W.h)(t=>!!t),(0,f.q)(1)).subscribe(t=>{t&&(this.gridService=t.gridService,this.gridService.getColumnFit$().pipe((0,m.R)(this.unsubscribe)).subscribe(s=>this.fitColumns=s))}),g.O.preventScroll();const i=Object.assign({},g.O.defaultGridOptions(this.gridUid,this.defaultColDef,this.gridState$,t=>t.id));this.gridOptions=Object.assign(Object.assign({},i),{frameworkComponents:Object.assign(Object.assign({},i.frameworkComponents),{booleanCellRenderer:z.N})}),this.gridReady$.pipe((0,m.R)(this.unsubscribe)).subscribe(()=>{this.gridService.setColDef(n.getColDefs())})}onGridReady(i){if(i){this.gridContext={dialogService:this.dialogService};const t=new P.r(i.api,i.columnApi);this.agGridInstanceService.saveGridInstance(this.gridUid,t,s=>s.id),this.gridReady$.next(!0)}}getContextMenuItems(i){var t;const{name:s,id:a}=(null===(t=i.node)||void 0===t?void 0:t.data)||{};return[{name:"Zobrazit",action:()=>{i.context.dialogService.showList(a,s)},icon:'<i class="fas fa-list text-info-color"></i>'},{name:"Smazat",action:()=>{i.context.dialogService.showConfirmDeleteAssetsList(a,s)},icon:'<i class="fas fa-minus text-danger-color"></i>'}]}ngOnDestroy(){this.unsubscribe.next(!0),this.agGridInstanceService.removeGridInstance(this.gridUid)}onRowDoubleClicked(i){var t;const s=i.node;(null===(t=s.data)||void 0===t?void 0:t.id)&&this.dialogService.showList(s.data.id,s.data.name)}onMouseDown(i){const t=g.O.rowClickIdExtractor(i);t&&(window.open("/lists/list/"+t,"_blank"),window.focus())}}return n.\u0275fac=function(i){return new(i||n)(e.Y36(y.$),e.Y36(B.G),e.Y36(Y.x),e.Y36(E.x))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-lists-list"]],features:[e.qOj],decls:5,vars:14,consts:[["fxFlex","","fxLayout","column"],[3,"gridUid"],["fxFlex","",1,"ag-theme-alpine",3,"ngClass","columnDefs","gridOptions","getContextMenuItems","context","rowData","gridColumnsChanged","gridSizeChanged","columnResized","displayedColumnsChanged","filterModified","gridReady","rowDoubleClicked","toolPanelVisibleChanged","mousedown"],[3,"rows","selectedRow","gridUid"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e._UZ(1,"app-views-bar",1),e.TgZ(2,"ag-grid-angular",2),e.NdJ("gridColumnsChanged",function(){return t.onGridColumnsChanged()})("gridSizeChanged",function(){return t.onGridSizeChanged()})("columnResized",function(){return t.onColumnResized()})("displayedColumnsChanged",function(){return t.onDisplayedColumnsChanged()})("filterModified",function(a){return t.onFilterModified(a)})("gridReady",function(a){return t.onGridReady(a)})("rowDoubleClicked",function(a){return t.onRowDoubleClicked(a)})("toolPanelVisibleChanged",function(a){return t.onPanelVisibilityChanged(a)})("mousedown",function(a){return t.onMouseDown(a)}),e.ALo(3,"async"),e.qZA(),e._UZ(4,"app-bar-under-ag-grid",3),e.qZA()),2&i){let s;e.xp6(1),e.Q6J("gridUid",t.gridUid),e.xp6(1),e.Q6J("ngClass",e.VKq(12,j,t.filterActive))("columnDefs",t.columnDefs)("gridOptions",t.gridOptions)("getContextMenuItems",t.getContextMenuItems)("context",t.gridContext)("rowData",e.lcZ(3,10,t.rowData$)),e.xp6(2),e.Q6J("rows",null!=t.gridService&&t.gridService.getDisplayedRowCount()?t.gridService.getDisplayedRowCount():0)("selectedRow",null!=t.gridService&&null!=(s=t.gridService.getSelectedNodes())&&s.length?t.gridService.getSelectedNodes().length:0)("gridUid",t.gridUid)}},directives:[u.yH,u.xw,L.z,S.N8,c.mk,Q.n],pipes:[c.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex}"]}),n})();var Z=o(8389);const K=[{path:"",component:h,children:[{path:"",component:$},{path:"working-list",component:M,data:{loadWorkingList:!0}},{path:"list/:id",component:Z.A}]}];let V=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[p.Bz.forChild(K)],p.Bz]}),n})();var H=o(5764),X=o(2344);let q=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n,bootstrap:[h]}),n.\u0275inj=e.cJS({imports:[[c.ez,V,H.AssetsModule,u.ae,r.P1,r.T2N,r.KdK,r.V7y,d.UX,r.nKr,r.wB1,S.sF,r.zyh,X.m,r.rgH]]}),n})();e.B6R(Z.A,[d._Y,d.JL,u.xw,u.SQ,d.sg,c.mk,u.yH,r.jBG,r.fMN,r.t3q,d.Fj,r.h8i,d.JJ,d.u,u.Wh,r.BLq,x.K,r.DPz,r.jNv,c.O5],[])}}]);